@using System.Linq
@using JournalSystem.Models
@inject IJSRuntime JS

<canvas id="top-words" width="400" height="200"></canvas>

@code {
    [Parameter]
    public List<WordCountResult> Words { get; set; } = new();

    bool chartRendered;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (chartRendered || Words == null || !Words.Any())
        {
            return;
        }

        var labels = Words.Select(w => w.Name).ToArray();
        var data = Words.Select(w => w.WordCount).ToArray();

        await JS.InvokeVoidAsync("initPieChart", "top-words", "Most Used Words", labels, data);
        chartRendered = true;
    }
}